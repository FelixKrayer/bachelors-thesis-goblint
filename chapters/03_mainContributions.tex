% !TeX root = ../main.tex
% Add the above to each chapter to make compiling the PDF easier in some editors.

\chapter{Main Contributions}\label{chapter:mainContributions}

  \section{Formal description}
    \subsection{Taint analysis}
      In this section we will propose our approach to reduce the aforementioned precision loss \ref{chapter:background}. The basic idea is to track for each procedure which variables have been written or have possibly been altered in some other way. This information is then used in the values-of-variables analysis when combining the abstract state from the caller with the abstract return state given by the callee at the end of the procedure.\\
      In the following we will call a variable that has been written or altered in the current function context "tainted". Therefore, we introduce a new taint analysis tracking which variables have been tainted within the context of the current function.\\
      First we formalize our taint analysis in the syntax for flow sensitive analyses we have built in the previous chapter \ref{chapter:background}:\\
      $\mathbb{D}_\textsf{t} = 2^X$ with $\sqsupseteq = \supseteq$\\
      $\eta_\textsf{t}: N \rightarrow \mathbb{D}_\textsf{t}$\\
      Each edge $e = (u, A, v)$ introduces the constraint $\eta_\textsf{t}\ [v] \sqsupseteq [\![  A ]\!] ^{\#}  (\eta_\textsf{t}\ [u]) $\\
      \[ [\![ x = y ]\!] ^{\#}\ T =  T \cup \{x\} \]
      \[ [\![ ^*x = y ]\!] ^{\#}\ T =  T \cup \textsf{MayPointTo}(x) \]
      
      \[ \textsf{enter}^{\#}\ T = \emptyset\]
      \[ \textsf{combine}^{\#}\ T_\textsf{cr}\ T_\textsf{ce} = T_\textsf{cr} \cup T_\textsf{ce} \]

    \subsection{Improving the values-of-variables analysis}
      \begin{align}
        \textsf{combine}^{\#} \eta_\textsf{cr}\ \eta_\textsf{ce} = & \text{let } \eta'_\textsf{cr} = \eta_\textsf{cr} \backslash T_\textsf{ce} \text{ in} \\
        & \text{let } \eta'_\textsf{ce} = \eta_\textsf{ce} \cap T_\textsf{ce} \text{ in} \\
        & \eta'_\textsf{cr} \cup \eta'_\textsf{ce}
      \end{align}

  \section{Implementation}
  % TODO: describe the implementation of taint (expand to lval)


